- name: Install dependencies
  apt: pkg={{ item }} state=installed
  with_items:
    - autoconf
    - automake
    - bison
    - build-essential
    - curl
    - exuberant-ctags
    - git-core
    - libreadline6
    - libreadline6-dev
    - libreadline-dev
    - libsqlite3-0
    - libsqlite3-dev
    - libssl-dev
    - libyaml-dev
    - libc6-dev
    - libncurses5-dev
    - libtool
    - libxml2-dev
    - libxslt1-dev
    - openssl
    - sqlite3
    - subversion
    - zlib1g
    - zlib1g-dev

- name: Install rbenv
  git: repo=git://github.com/sstephenson/rbenv.git dest=~/.rbenv accept_hostkey=true

# - name: Copy rbenv.sh to remote
#   copy: src=../files/rbenv.sh dest=~/.rbenv.sh
#
# - name: Install rbenv shims
#   copy: src=rbenv.sh dest=~/.rbenv.sh mode=700 owner='vagrant'
#
# - name: Source rbenv shims file
#   lineinfile: dest=~/.bashrc insertafter=EOF line="source ~/.rbenv.sh" create=yes

- name: Add rbenv path to .bashrc
  shell: echo 'export PATH="$HOME/.rbenv/bin:$PATH"' >> ~/.bashrc
  shell: echo 'eval "$(rbenv init -)"' >> ~/.bashrc
  shell: exec $SHELL
  
- name: Install ruby-build
  git: repo=git://github.com/sstephenson/ruby-build.git dest=~/.rbenv/plugins/ruby-build accept_hostkey=true
